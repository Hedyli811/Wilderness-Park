import{a as U,b as $,c as O,G as z,H as F,d as A,e as R,f as P,w as T,A as K}from"./element-plus@2.3.6_vue@3.2.47-b0afb102.js";import{b as M,w as W}from"./@vue_runtime-dom@3.2.47-29a82bf7.js";import{h as i,a as j}from"./index-bc56dcd5.js";import{D as G}from"./debounce-d39f6322.js";import{r as p,j as S,u as a,i as q}from"./@vue_reactivity@3.2.47-f1f0bfd6.js";import{o as s,K as k,L as o,a as H,e as r,P as f,c as h,n as w,O as E,Y as L}from"./@vue_runtime-core@3.2.47-fc168a25.js";import"./lodash-es@4.17.21-53d52778.js";import"./@vue_shared@3.2.47-ad77ec3c.js";import"./@ctrl_tinycolor@3.6.1-6620e546.js";import"./@vueuse_core@9.13.0_vue@3.2.47-9c54f61c.js";import"./@vueuse_shared@9.13.0_vue@3.2.47-c9be2d58.js";import"./@element-plus_icons-vue@2.1.0_vue@3.2.47-0922d443.js";import"./@sxzz_popperjs-es@2.11.7-17ad78e6.js";import"./dayjs@1.11.19-0819d722.js";import"./async-validator@4.2.5-62e2fe13.js";import"./memoize-one@6.0.0-7e4bb68a.js";import"./escape-html@1.0.3-4e0a8349.js";import"./normalize-wheel-es@1.2.0-723c8681.js";import"./@floating-ui_dom@1.7.4-7095b9f8.js";import"./@floating-ui_core@1.7.3-3f397b79.js";import"./@floating-ui_utils@0.2.10-53750fea.js";import"./lodash-unified@1.0.3_@types_97fcb82fcbefb8c62463eca8780b3bb2-079fba74.js";import"./vue@3.2.47-78ff42bf.js";import"./pinia@2.0.33_vue@3.2.47-113b2d6e.js";import"./vue-demi@0.14.10_vue@3.2.47-71ba0ef2.js";import"./moment@2.29.4-4717c495.js";import"./vue-router@4.1.6_vue@3.2.47-157ae188.js";import"./vue-cookies@1.8.3-3659d826.js";import"./axios@1.3.4-7f28dcc5.js";import"./qs@6.11.1-52add623.js";import"./side-channel@1.1.0-d2eaf7ff.js";import"./es-errors@1.3.0-c75f5a96.js";import"./object-inspect@1.13.4-e0b94579.js";import"./crypto-js@4.1.1-034e6822.js";import"./side-channel-list@1.0.0-52efb099.js";import"./side-channel-map@1.0.1-41168540.js";import"./get-intrinsic@1.3.0-829e561c.js";import"./es-object-atoms@1.1.1-11ea1ab9.js";import"./math-intrinsics@1.1.0-9389030e.js";import"./gopd@1.2.0-f4eec54c.js";import"./es-define-property@1.0.1-88d30046.js";import"./has-symbols@1.1.0-1e41ff1e.js";import"./get-proto@1.0.1-a9f527cc.js";import"./dunder-proto@1.0.1-62f72dc7.js";import"./call-bind-apply-helpers@1.0.2-03b6ca7f.js";import"./function-bind@1.1.2-48f717dc.js";import"./hasown@2.0.2-f810df7c.js";import"./call-bound@1.0.4-15e4d619.js";import"./side-channel-weakmap@1.0.2-6131bab0.js";import"./lodash@4.17.21-30260a07.js";import"./@smallwei_avue@3.2.22_eleme_cfde8b18620b223d8d5d842b89bb35e0-19420b51.js";const Y={searchMenuSpan:6,columnBtn:!1,border:!0,index:!1,indexLabel:"序号",stripe:!0,menuAlign:"center",menuWidth:350,align:"center",refreshBtn:!0,searchSize:"mini",addBtn:!1,editBtn:!1,delBtn:!1,viewBtn:!1,props:{label:"label",value:"value"},column:[{label:"用户昵称",prop:"nickName",search:!0},{label:"用户头像",prop:"pic",type:"upload",imgWidth:150,listType:"picture-img",slot:!0},{label:"状态",prop:"status",search:!0,type:"select",slot:!0,dicData:[{label:"禁用",value:0},{label:"正常",value:1}]},{label:"注册时间",prop:"userRegtime",imgWidth:150}]},J=["src"],Q={key:1},X={class:"dialog-footer"},Z={__name:"add-or-update",emits:["refreshDataList"],setup(x,{expose:y,emit:V}){const u=p(!1),t=p({userId:0,nickName:"",pic:"",status:1}),m=S({total:0,currentPage:1,pageSize:10}),b={nickName:[{required:!0,message:"用户名不能为空",trigger:"blur"}]},g=p(null);y({init:d=>{t.value.userId=d||0,u.value=!0,w(()=>{var e;(e=g.value)==null||e.resetFields()}),t.value.userId&&i({url:i.adornUrl(`/admin/user/info/${t.value.userId}`),method:"get",params:i.adornParams()}).then(({data:e})=>{t.value=e})}});const I=G(()=>{var d;(d=g.value)==null||d.validate(e=>{e&&i({url:i.adornUrl("/admin/user"),method:t.value.userId?"put":"post",data:i.adornData({userId:t.value.userId||void 0,nickName:t.value.nickName,status:t.value.status})}).then(()=>{U({message:"操作成功",type:"success",duration:1500,onClose:()=>{u.value=!1,V("refreshDataList",m)}})})})});return(d,e)=>{const l=$,v=O,c=z,N=F,C=A,B=R,_=P;return s(),k(_,{modelValue:a(u),"onUpdate:modelValue":e[5]||(e[5]=n=>q(u)?u.value=n:null),title:a(t).userId?"修改":"新增","close-on-click-modal":!1},{footer:o(()=>[H("span",X,[r(B,{onClick:e[3]||(e[3]=n=>u.value=!1)},{default:o(()=>[f("取消")]),_:1}),r(B,{type:"primary",onClick:e[4]||(e[4]=n=>a(I)())},{default:o(()=>[f("确定")]),_:1})])]),default:o(()=>[r(C,{ref_key:"dataFormRef",ref:g,model:a(t),rules:b,"label-width":"80px",onKeyup:e[2]||(e[2]=M(n=>a(I)(),["enter"]))},{default:o(()=>[r(l,{label:"用户头像",prop:"pic"},{default:o(()=>[a(t).pic?(s(),h("img",{key:0,src:a(t).pic,class:"image",alt:""},null,8,J)):(s(),h("div",Q," 无 "))]),_:1}),r(l,{label:"用户昵称",prop:"nickName"},{default:o(()=>[r(v,{modelValue:a(t).nickName,"onUpdate:modelValue":e[0]||(e[0]=n=>a(t).nickName=n),disabled:!0,placeholder:"用户昵称"},null,8,["modelValue"])]),_:1}),r(l,{label:"状态",prop:"status"},{default:o(()=>[r(N,{modelValue:a(t).status,"onUpdate:modelValue":e[1]||(e[1]=n=>a(t).status=n)},{default:o(()=>[r(c,{label:0},{default:o(()=>[f(" 禁用 ")]),_:1}),r(c,{label:1},{default:o(()=>[f(" 正常 ")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}},ee={class:"mod-user"},te={key:0,class:"avue-crud__img"},oe={key:1},et={__name:"index",setup(x){const y=p([]),V=p(!1),u=p([]),t=p(!1),m=S({total:0,currentPage:1,pageSize:10}),b=(e,l,v)=>{V.value=!0,i({url:i.adornUrl("/admin/user/page"),method:"get",params:i.adornParams(Object.assign({current:e==null?m.currentPage:e.currentPage,size:e==null?m.pageSize:e.pageSize},l))}).then(({data:c})=>{y.value=c.records,m.total=c.total,V.value=!1,v&&v()})},g=p(null),D=e=>{t.value=!0,w(()=>{var l;(l=g.value)==null||l.init(e)})},I=(e,l)=>{b(m,e,l)},d=e=>{u.value=e};return(e,l)=>{const v=L("Document"),c=T,N=K,C=R,B=L("avue-crud");return s(),h("div",ee,[r(B,{ref:"crudRef",page:a(m),data:a(y),option:a(Y),onSearchChange:I,onSelectionChange:d,onOnLoad:b},{pic:o(_=>[_.row.pic?(s(),h("span",te,[r(c,null,{default:o(()=>[r(v)]),_:1})])):(s(),h("span",oe,"-"))]),status:o(_=>[_.row.status===0?(s(),k(N,{key:0,type:"danger"},{default:o(()=>[f(" 禁用 ")]),_:1})):(s(),k(N,{key:1},{default:o(()=>[f(" 正常 ")]),_:1}))]),menu:o(_=>[a(j)("admin:user:update")?(s(),k(C,{key:0,type:"primary",icon:"el-icon-edit",onClick:W(n=>D(_.row.userId),["stop"])},{default:o(()=>[f(" 编辑 ")]),_:2},1032,["onClick"])):E("",!0)]),_:1},8,["page","data","option"]),a(t)?(s(),k(Z,{key:0,ref_key:"addOrUpdateRef",ref:g,onRefreshDataList:b},null,512)):E("",!0)])}}};export{et as default};
