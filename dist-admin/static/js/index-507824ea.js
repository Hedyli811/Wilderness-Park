import{c as S,b as F,G as M,H as z,d as A,e as B,f as N,a as D,g as K,A as P}from"./element-plus@2.3.6_vue@3.2.47-b0afb102.js";import{b as j,w as G}from"./@vue_runtime-dom@3.2.47-29a82bf7.js";import{h as u,a as R}from"./index-6667c2ae.js";import{_ as I}from"./index-f9df8b25.js";import{D as q}from"./debounce-d39f6322.js";import{r as v,u as a,i as H,j as Y}from"./@vue_reactivity@3.2.47-f1f0bfd6.js";import{o as c,K as f,L as t,a as J,e as n,P as i,n as w,c as Q,O as T,Y as W}from"./@vue_runtime-core@3.2.47-fc168a25.js";import"./lodash-es@4.17.21-53d52778.js";import"./@vue_shared@3.2.47-ad77ec3c.js";import"./@ctrl_tinycolor@3.6.1-6620e546.js";import"./@vueuse_core@9.13.0_vue@3.2.47-9c54f61c.js";import"./@vueuse_shared@9.13.0_vue@3.2.47-c9be2d58.js";import"./@element-plus_icons-vue@2.1.0_vue@3.2.47-0922d443.js";import"./@sxzz_popperjs-es@2.11.7-17ad78e6.js";import"./dayjs@1.11.19-0819d722.js";import"./async-validator@4.2.5-62e2fe13.js";import"./memoize-one@6.0.0-7e4bb68a.js";import"./escape-html@1.0.3-4e0a8349.js";import"./normalize-wheel-es@1.2.0-723c8681.js";import"./@floating-ui_dom@1.7.4-7095b9f8.js";import"./@floating-ui_core@1.7.3-3f397b79.js";import"./@floating-ui_utils@0.2.10-53750fea.js";import"./lodash-unified@1.0.3_@types_97fcb82fcbefb8c62463eca8780b3bb2-079fba74.js";import"./vue@3.2.47-78ff42bf.js";import"./pinia@2.0.33_vue@3.2.47-113b2d6e.js";import"./vue-demi@0.14.10_vue@3.2.47-71ba0ef2.js";import"./moment@2.29.4-4717c495.js";import"./vue-router@4.1.6_vue@3.2.47-157ae188.js";import"./vue-cookies@1.8.3-3659d826.js";import"./axios@1.3.4-7f28dcc5.js";import"./qs@6.11.1-6c5b1c66.js";import"./side-channel@1.1.0-50535f43.js";import"./es-errors@1.3.0-c75f5a96.js";import"./object-inspect@1.13.4-e0b94579.js";import"./crypto-js@4.1.1-034e6822.js";import"./side-channel-list@1.0.0-52efb099.js";import"./side-channel-map@1.0.1-3d184ac6.js";import"./get-intrinsic@1.3.0-cf5c2bd1.js";import"./es-object-atoms@1.1.1-11ea1ab9.js";import"./math-intrinsics@1.1.0-9389030e.js";import"./gopd@1.2.0-f4eec54c.js";import"./es-define-property@1.0.1-88d30046.js";import"./has-symbols@1.1.0-1e41ff1e.js";import"./get-proto@1.0.1-b58db3ef.js";import"./dunder-proto@1.0.1-b234d88c.js";import"./call-bind-apply-helpers@1.0.2-ab6903ca.js";import"./function-bind@1.1.2-61637ca6.js";import"./hasown@2.0.2-f331d4a8.js";import"./call-bound@1.0.4-165459bc.js";import"./side-channel-weakmap@1.0.2-b72a0d20.js";import"./lodash@4.17.21-30260a07.js";import"./@smallwei_avue@3.2.22_eleme_cfde8b18620b223d8d5d842b89bb35e0-19420b51.js";const X={searchMenuSpan:6,columnBtn:!1,border:!0,index:!0,indexLabel:"序号",stripe:!0,menuAlign:"center",align:"center",addBtn:!1,editBtn:!1,delBtn:!1,column:[{label:"公告内容",prop:"title",search:!0},{label:"状态",prop:"status",search:!0,slot:!0,type:"select",dicData:[{label:"撤销",value:0},{label:"公布",value:1}]},{label:"是否置顶",prop:"isTop",search:!0,slot:!0,type:"select",dicData:[{label:"否",value:0},{label:"是",value:1}]}]},Z={class:"dialog-footer"},ee={__name:"add-or-update",emits:["refreshDataList"],setup(L,{expose:k,emit:_}){const m=v(!1),b=v(null),V={title:[{required:!0,message:"公告标题不能为空",trigger:"blur"},{validator:(l,e,r)=>{e.trim()?r():(o.value.title="",r(new Error("公告标题不能为空")))},trigger:"blur"}]},o=v({title:null,content:null,url:null,status:1,isTop:0}),h=v(null);k({init:l=>{o.value.id=l||0,m.value=!0,w(()=>{var e;(e=h.value)==null||e.resetFields(),o.value.id&&u({url:u.adornUrl("/shop/notice/info/"+o.value.id),method:"get",params:u.adornParams()}).then(({data:r})=>{o.value=r})})}});const C=q(()=>{var l;(l=h.value)==null||l.validate(e=>{e&&u({url:u.adornUrl("/shop/notice"),method:o.value.id?"put":"post",data:u.adornData(o.value)}).then(()=>{D({message:"操作成功",type:"success",duration:1500,onClose:()=>{m.value=!1,_("refreshDataList"),o.value.content=""}})})})});return(l,e)=>{const r=S,p=F,g=M,d=z,x=I,$=A,U=B,O=N;return c(),f(O,{modelValue:a(m),"onUpdate:modelValue":e[7]||(e[7]=s=>H(m)?m.value=s:null),title:a(o).id?"修改":"新增","close-on-click-modal":!1},{footer:t(()=>[J("span",Z,[n(U,{onClick:e[5]||(e[5]=s=>m.value=!1)},{default:t(()=>[i("取消")]),_:1}),n(U,{type:"primary",onClick:e[6]||(e[6]=s=>a(C)())},{default:t(()=>[i("确定")]),_:1})])]),default:t(()=>[n($,{ref_key:"dataFormRef",ref:h,model:a(o),rules:V,"label-width":"80px",onKeyup:e[4]||(e[4]=j(s=>a(C)(),["enter"]))},{default:t(()=>[n(p,{label:"公告标题",prop:"title"},{default:t(()=>[n(r,{modelValue:a(o).title,"onUpdate:modelValue":e[0]||(e[0]=s=>a(o).title=s)},null,8,["modelValue"])]),_:1}),n(p,{label:"状态",prop:"status"},{default:t(()=>[n(d,{modelValue:a(o).status,"onUpdate:modelValue":e[1]||(e[1]=s=>a(o).status=s)},{default:t(()=>[n(g,{label:1},{default:t(()=>[i(" 公布 ")]),_:1}),n(g,{label:0},{default:t(()=>[i(" 撤销 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(p,{label:"置顶",prop:"isTop"},{default:t(()=>[n(d,{modelValue:a(o).isTop,"onUpdate:modelValue":e[2]||(e[2]=s=>a(o).isTop=s)},{default:t(()=>[n(g,{label:1},{default:t(()=>[i(" 是 ")]),_:1}),n(g,{label:0},{default:t(()=>[i(" 否 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(p,{label:"公告内容",prop:"content"},{default:t(()=>[n(x,{ref_key:"contentEnRef",ref:b,modelValue:a(o).content,"onUpdate:modelValue":e[3]||(e[3]=s=>a(o).content=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}},te={class:"mod-shop-notice"},et={__name:"index",setup(L){const k=v([]),_=Y({total:0,currentPage:1,pageSize:10}),m=v(!1),b=v(!1),y=(l,e,r)=>{m.value=!0,u({url:u.adornUrl("/shop/notice/page"),method:"get",params:u.adornParams(Object.assign({current:l==null?_.currentPage:l.currentPage,size:l==null?_.pageSize:l.pageSize},e))}).then(({data:p})=>{k.value=p.records,_.total=p.total,m.value=!1,r&&r()})},V=v(null),o=l=>{b.value=!0,w(()=>{var e;(e=V.value)==null||e.init(l)})},h=l=>{K.confirm("确定进行删除操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{u({url:u.adornUrl("/shop/notice/"+l),method:"delete",data:u.adornData({})}).then(()=>{D({message:"操作成功",type:"success",duration:1500,onClose:()=>{y()}})})}).catch(()=>{})},E=()=>{y(_)},C=(l,e)=>{y(_,l,e)};return(l,e)=>{const r=P,p=B,g=W("avue-crud");return c(),Q("div",te,[n(g,{ref:"crudRef",page:a(_),data:a(k),"table-loading":a(m),option:a(X),onSearchChange:C,onOnLoad:y,onRefreshChange:E},{status:t(d=>[d.row.status===0?(c(),f(r,{key:0,type:"danger"},{default:t(()=>[i(" 撤销 ")]),_:1})):(c(),f(r,{key:1},{default:t(()=>[i(" 公布 ")]),_:1}))]),isTop:t(d=>[d.row.isTop===0?(c(),f(r,{key:0},{default:t(()=>[i(" 否 ")]),_:1})):(c(),f(r,{key:1},{default:t(()=>[i(" 是 ")]),_:1}))]),"menu-left":t(()=>[a(R)("shop:notice:save")?(c(),f(p,{key:0,type:"primary",icon:"el-icon-plus",onClick:e[0]||(e[0]=d=>o())},{default:t(()=>[i(" 新增 ")]),_:1})):T("",!0)]),menu:t(d=>[a(R)("shop:notice:update")?(c(),f(p,{key:0,type:"primary",icon:"el-icon-edit",onClick:x=>o(d.row.id)},{default:t(()=>[i(" 修改 ")]),_:2},1032,["onClick"])):T("",!0),a(R)("shop:notice:delete")?(c(),f(p,{key:1,type:"danger",icon:"el-icon-delete",onClick:G(x=>h(d.row.id),["stop"])},{default:t(()=>[i(" 删除 ")]),_:2},1032,["onClick"])):T("",!0)]),_:1},8,["page","data","table-loading","option"]),a(b)?(c(),f(ee,{key:0,ref_key:"addOrUpdateRef",ref:V,onRefreshDataList:E,onClose:e[1]||(e[1]=d=>b.value=!1)},null,512)):T("",!0)])}}};export{et as default};
