import{a as V,c as z,B as A,D as M,e as U,C as R,f as j,g as F,A as J}from"./element-plus@2.3.6_vue@3.2.47-b0afb102.js";import{v as W,w as O}from"./@vue_runtime-dom@3.2.47-29a82bf7.js";import{_ as D,h as c,a as C}from"./index-6667c2ae.js";import{D as K}from"./debounce-d39f6322.js";import{r as f,u as s,i as Y,j as q}from"./@vue_reactivity@3.2.47-f1f0bfd6.js";import{o as d,K as g,L as r,a as G,e as i,P,c as S,F as L,W as E,M as H,O as I,Y as Q,n as X}from"./@vue_runtime-core@3.2.47-fc168a25.js";import{O as Z}from"./@vue_shared@3.2.47-ad77ec3c.js";import"./lodash-es@4.17.21-53d52778.js";import"./@vueuse_core@9.13.0_vue@3.2.47-9c54f61c.js";import"./@vueuse_shared@9.13.0_vue@3.2.47-c9be2d58.js";import"./@ctrl_tinycolor@3.6.1-6620e546.js";import"./@element-plus_icons-vue@2.1.0_vue@3.2.47-0922d443.js";import"./@sxzz_popperjs-es@2.11.7-17ad78e6.js";import"./dayjs@1.11.19-0819d722.js";import"./async-validator@4.2.5-62e2fe13.js";import"./memoize-one@6.0.0-7e4bb68a.js";import"./escape-html@1.0.3-4e0a8349.js";import"./normalize-wheel-es@1.2.0-723c8681.js";import"./@floating-ui_dom@1.7.4-7095b9f8.js";import"./@floating-ui_core@1.7.3-3f397b79.js";import"./@floating-ui_utils@0.2.10-53750fea.js";import"./lodash-unified@1.0.3_@types_97fcb82fcbefb8c62463eca8780b3bb2-079fba74.js";import"./vue@3.2.47-78ff42bf.js";import"./pinia@2.0.33_vue@3.2.47-113b2d6e.js";import"./vue-demi@0.14.10_vue@3.2.47-71ba0ef2.js";import"./moment@2.29.4-4717c495.js";import"./vue-router@4.1.6_vue@3.2.47-157ae188.js";import"./vue-cookies@1.8.3-3659d826.js";import"./axios@1.3.4-7f28dcc5.js";import"./qs@6.11.1-6c5b1c66.js";import"./side-channel@1.1.0-50535f43.js";import"./es-errors@1.3.0-c75f5a96.js";import"./object-inspect@1.13.4-e0b94579.js";import"./crypto-js@4.1.1-034e6822.js";import"./side-channel-list@1.0.0-52efb099.js";import"./side-channel-map@1.0.1-3d184ac6.js";import"./get-intrinsic@1.3.0-cf5c2bd1.js";import"./es-object-atoms@1.1.1-11ea1ab9.js";import"./math-intrinsics@1.1.0-9389030e.js";import"./gopd@1.2.0-f4eec54c.js";import"./es-define-property@1.0.1-88d30046.js";import"./has-symbols@1.1.0-1e41ff1e.js";import"./get-proto@1.0.1-b58db3ef.js";import"./dunder-proto@1.0.1-b234d88c.js";import"./call-bind-apply-helpers@1.0.2-ab6903ca.js";import"./function-bind@1.1.2-61637ca6.js";import"./hasown@2.0.2-f331d4a8.js";import"./call-bound@1.0.4-165459bc.js";import"./side-channel-weakmap@1.0.2-b72a0d20.js";import"./lodash@4.17.21-30260a07.js";import"./@smallwei_avue@3.2.22_eleme_cfde8b18620b223d8d5d842b89bb35e0-19420b51.js";const ee={class:"dialog-footer"},oe={__name:"add-or-update",emits:["refreshDataList"],setup($,{expose:N,emit:b}){const m=f(!1),e=f([{propId:0,propName:"",prodPropValues:[{valueId:0}]}]),_={total:0,currentPage:1,pageSize:10};N({init:o=>{o?e.value=[JSON.parse(JSON.stringify(o))]:e.value=[{propId:0,propName:"",prodPropValues:[{valueId:0}]}],m.value=!0}});const k=K(()=>{if(e.value[0].prodPropValues){const o=[];for(const a in e.value[0].prodPropValues)e.value[0].prodPropValues.hasOwnProperty(a)&&e.value[0].prodPropValues[a].propValue&&o.push(e.value[0].prodPropValues[a]);e.value[0].prodPropValues=o}if(!e.value[0].propName.trim()){e.value[0].propName="",V.error("属性名不能为空");return}if(e.value[0].prodPropValues.length<1){e.value[0].prodPropValues=[{valueId:0}],V.error("规格项不能为空");return}if(e.value[0].propName.length>10){V.error("属性名称长度不能大于10");return}if(e.value[0].prodPropValues.find(o=>!o.propValue.trim())){V.error("属性值不能为空");return}if(e.value[0].prodPropValues.find(o=>o.propValue.length>20)){V.error("属性值长度不能大于20");return}c({url:c.adornUrl("/prod/spec"),method:e.value[0].propId?"put":"post",data:c.adornData({propId:e.value[0].propId||void 0,propName:e.value[0].propName,prodPropValues:e.value[0].prodPropValues})}).then(()=>{V({message:"操作成功",type:"success",duration:1500,onClose:()=>{m.value=!1,b("refreshDataList",_)}})})}),w=()=>{if(e.value[0].prodPropValues.length!==1)for(let o=0;o<e.value[0].prodPropValues.length;o++)e.value[0].prodPropValues[o].propValue||e.value[0].prodPropValues.splice(o,1)},x=()=>{const o=e.value[0].prodPropValues;o[o.length-1].propValue&&o.push({})};return(o,a)=>{const t=z,l=A,u=M,n=U,B=R,v=j;return d(),g(v,{modelValue:s(m),"onUpdate:modelValue":a[3]||(a[3]=p=>Y(m)?m.value=p:null),title:s(e)[0].propId?"修改":"新增","close-on-click-modal":!1},{footer:r(()=>[G("div",ee,[i(n,{onClick:a[1]||(a[1]=p=>m.value=!1)},{default:r(()=>[P(" 取消 ")]),_:1}),i(n,{type:"primary",onClick:a[2]||(a[2]=p=>s(k)())},{default:r(()=>[P(" 确定 ")]),_:1})])]),default:r(()=>[i(B,{data:s(e),border:"",style:{width:"100%"}},{default:r(()=>[i(l,{prop:"propName","header-align":"center",align:"center",label:"属性名称"},{default:r(p=>[i(t,{modelValue:p.row.propName,"onUpdate:modelValue":h=>p.row.propName=h,placeholder:"请输入内容",maxlength:"10","show-word-limit":"",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),i(l,{prop:"prodPropValues","header-align":"center",align:"center",label:"属性值"},{default:r(p=>[(d(!0),S(L,null,E(p.row.prodPropValues,h=>(d(),g(u,{key:h.valueId,span:12},{default:r(()=>[i(t,{modelValue:h.propValue,"onUpdate:modelValue":T=>h.propValue=T,placeholder:"请输入内容",class:"prop-value-input",maxlength:"20","show-word-limit":"",clearable:"",onClear:w},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))),128)),i(u,{span:4},{default:r(()=>[H(i(n,{type:"primary",class:"add-input",icon:"el-icon-circle-plus",onClick:a[0]||(a[0]=h=>x())},null,512),[[W,p.row.prodPropValues[p.row.prodPropValues.length-1].propValue]])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue","title"])}}},te=D(oe,[["__scopeId","data-v-e33b4053"]]),re={searchMenuSpan:6,columnBtn:!1,border:!0,index:!0,indexLabel:"序号",stripe:!0,menuAlign:"center",menuWidth:350,align:"center",refreshBtn:!0,searchSize:"mini",addBtn:!1,editBtn:!1,viewBtn:!1,delBtn:!1,props:{label:"label",value:"value"},column:[{label:"属性名称",prop:"propName",search:!0},{label:"属性值",prop:"prodPropValues",slot:!0}]};const ae={class:"mod-prod"},le={__name:"index",setup($){const N=f({delBtn:C("prod:prod:delete")}),b=f([]),m=f(!1),e=f([]),_=q({total:0,currentPage:1,pageSize:10}),y=(t,l,u)=>{m.value=!0,c({url:c.adornUrl("/prod/spec/page"),method:"get",params:c.adornParams(Object.assign({current:t==null?_.currentPage:t.currentPage,size:t==null?_.pageSize:t.pageSize},l))}).then(({data:n})=>{b.value=n.records,_.total=n.total,m.value=!1,u&&u()})},k=f(!1),w=f(null),x=t=>{k.value=!0,X(()=>{var l;(l=w.value)==null||l.init(t)})},o=t=>{var u;const l=t?[t]:(u=e.value)==null?void 0:u.map(n=>n.propId);F.confirm(`确定进行[${t?"删除":"批量删除"}]操作?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{c({url:c.adornUrl(`/prod/spec/${l}`),method:"delete",data:c.adornData(l,!1)}).then(()=>{V({message:"操作成功",type:"success",duration:1500,onClose:()=>{y(_)}})})}).catch(()=>{})},a=(t,l)=>{y(_,t,l)};return(t,l)=>{const u=J,n=U,B=Q("avue-crud");return d(),S("div",ae,[i(B,{ref:"crudRef",page:s(_),data:s(b),option:s(re),permission:s(N),onSearchChange:a,onOnLoad:y},{prodPropValues:r(v=>[(d(!0),S(L,null,E(v.row.prodPropValues,p=>(d(),g(u,{key:p.valueId},{default:r(()=>[P(Z(p.propValue),1)]),_:2},1024))),128))]),"menu-left":r(()=>[s(C)("shop:pickAddr:save")?(d(),g(n,{key:0,type:"primary",icon:"el-icon-plus",onClick:l[0]||(l[0]=O(v=>x(),["stop"]))},{default:r(()=>[P(" 新增 ")]),_:1})):I("",!0)]),menu:r(v=>[s(C)("prod:spec:update")?(d(),g(n,{key:0,type:"primary",icon:"el-icon-edit",onClick:O(p=>x(v.row),["stop"])},{default:r(()=>[P(" 编辑 ")]),_:2},1032,["onClick"])):I("",!0),s(C)("prod:spec:delete")?(d(),g(n,{key:1,type:"danger",icon:"el-icon-delete",onClick:O(p=>o(v.row.propId),["stop"])},{default:r(()=>[P(" 删除 ")]),_:2},1032,["onClick"])):I("",!0)]),_:1},8,["page","data","option","permission"]),s(k)?(d(),g(te,{key:0,ref_key:"addOrUpdateRef",ref:w,onRefreshDataList:y},null,512)):I("",!0)])}}},ro=D(le,[["__scopeId","data-v-a0185eb7"]]);export{ro as default};
