import{a as z,c as W,b as Y,y as G,z as H,D as J,d as Q,e as M,f as X,g as Z}from"./element-plus@2.3.6_vue@3.2.47-b0afb102.js";import{b as ee,w as $}from"./@vue_runtime-dom@3.2.47-29a82bf7.js";import{h as s,b as ae,a as S}from"./index-6667c2ae.js";import{D as te}from"./debounce-d39f6322.js";import{r as g,j as P,u as t,i as re}from"./@vue_reactivity@3.2.47-f1f0bfd6.js";import{o as u,K as b,L as l,a as le,e as o,P as N,c as x,F as O,W as F,n as q,O as B,Y as oe}from"./@vue_runtime-core@3.2.47-fc168a25.js";import"./lodash-es@4.17.21-53d52778.js";import"./@vue_shared@3.2.47-ad77ec3c.js";import"./@ctrl_tinycolor@3.6.1-6620e546.js";import"./@vueuse_core@9.13.0_vue@3.2.47-9c54f61c.js";import"./@vueuse_shared@9.13.0_vue@3.2.47-c9be2d58.js";import"./@element-plus_icons-vue@2.1.0_vue@3.2.47-0922d443.js";import"./@sxzz_popperjs-es@2.11.7-17ad78e6.js";import"./dayjs@1.11.19-0819d722.js";import"./async-validator@4.2.5-62e2fe13.js";import"./memoize-one@6.0.0-7e4bb68a.js";import"./escape-html@1.0.3-4e0a8349.js";import"./normalize-wheel-es@1.2.0-723c8681.js";import"./@floating-ui_dom@1.7.4-7095b9f8.js";import"./@floating-ui_core@1.7.3-3f397b79.js";import"./@floating-ui_utils@0.2.10-53750fea.js";import"./lodash-unified@1.0.3_@types_97fcb82fcbefb8c62463eca8780b3bb2-079fba74.js";import"./vue@3.2.47-78ff42bf.js";import"./pinia@2.0.33_vue@3.2.47-113b2d6e.js";import"./vue-demi@0.14.10_vue@3.2.47-71ba0ef2.js";import"./moment@2.29.4-4717c495.js";import"./vue-router@4.1.6_vue@3.2.47-157ae188.js";import"./vue-cookies@1.8.3-3659d826.js";import"./axios@1.3.4-7f28dcc5.js";import"./qs@6.11.1-6c5b1c66.js";import"./side-channel@1.1.0-50535f43.js";import"./es-errors@1.3.0-c75f5a96.js";import"./object-inspect@1.13.4-e0b94579.js";import"./crypto-js@4.1.1-034e6822.js";import"./side-channel-list@1.0.0-52efb099.js";import"./side-channel-map@1.0.1-3d184ac6.js";import"./get-intrinsic@1.3.0-cf5c2bd1.js";import"./es-object-atoms@1.1.1-11ea1ab9.js";import"./math-intrinsics@1.1.0-9389030e.js";import"./gopd@1.2.0-f4eec54c.js";import"./es-define-property@1.0.1-88d30046.js";import"./has-symbols@1.1.0-1e41ff1e.js";import"./get-proto@1.0.1-b58db3ef.js";import"./dunder-proto@1.0.1-b234d88c.js";import"./call-bind-apply-helpers@1.0.2-ab6903ca.js";import"./function-bind@1.1.2-61637ca6.js";import"./hasown@2.0.2-f331d4a8.js";import"./call-bound@1.0.4-165459bc.js";import"./side-channel-weakmap@1.0.2-b72a0d20.js";import"./lodash@4.17.21-30260a07.js";import"./@smallwei_avue@3.2.22_eleme_cfde8b18620b223d8d5d842b89bb35e0-19420b51.js";const de={class:"dialog-footer"},ne={__name:"add-or-update",emits:["refreshDataList"],setup(T,{expose:A,emit:U}){const m=g(!1),V={addrName:[{required:!0,message:"自提点名称不能为空",trigger:"blur"},{pattern:/\s\S+|S+\s|\S/,message:"请输入正确的自提点名称",trigger:"blur"}],addr:[{required:!0,message:"地址不能为空",trigger:"blur"},{pattern:/\s\S+|S+\s|\S/,message:"请输入正确的地址",trigger:"blur"}],city:[{required:!0,message:"城市不能为空",trigger:"blur"}],province:[{required:!0,message:"省份不能为空",trigger:"blur"}],area:[{required:!0,message:"区/县不能为空",trigger:"blur"}],mobile:[{required:!0,message:"手机号不能为空",trigger:"blur"},{validator:(n,e,v)=>{ae(e)?v():v(new Error("手机号格式错误"))},trigger:"blur"}]},I=g([]),C=g(null),c=g([]),f=g([]),a=P({addrId:0,addr:"",addrName:"",mobile:"",area:"",city:"",province:"",areaId:null,cityId:null,provinceId:null}),L=P({total:0,currentPage:1,pageSize:10});A({init:n=>{a.addrId=n||0,m.value=!0,q(()=>{var e;(e=C.value)==null||e.resetFields(),c.value=[],f.value=[],a.provinceId=null,a.cityId=null,a.areaId=null}),d().then(({data:e})=>{I.value=e}),a.addrId&&s({url:s.adornUrl(`/shop/pickAddr/info/${a.addrId}`),method:"get",params:s.adornParams()}).then(({data:e})=>{a.addr=e.addr,a.mobile=e.mobile,a.addrName=e.addrName,a.areaId=e.areaId,a.cityId=e.cityId,a.provinceId=e.provinceId,d(e.provinceId).then(({data:v})=>{c.value=v}),d(e.cityId).then(({data:v})=>{f.value=v})})}});const d=n=>(n||(n=0),s({url:s.adornUrl("/admin/area/listByPid"),method:"get",params:s.adornParams({pid:n})})),p=n=>{a.cityId=null,a.city="",d(n).then(({data:e})=>{c.value=e})},_=n=>{a.areaId=null,a.area="",d(n).then(({data:e})=>{f.value=e})},h=te(()=>{var n;for(let e=0;e<I.value.length;e++)I.value[e].areaId===a.provinceId&&(a.province=I.value[e].areaName);for(let e=0;e<c.value.length;e++)c.value[e].areaId===a.cityId&&(a.city=c.value[e].areaName);for(let e=0;e<f.value.length;e++)f.value[e].areaId===a.areaId&&(a.area=f.value[e].areaName);(n=C.value)==null||n.validate(e=>{e&&s({url:s.adornUrl("/shop/pickAddr"),method:a.addrId?"put":"post",data:s.adornData({addrId:a.addrId||void 0,addr:a.addr,addrName:a.addrName,mobile:a.mobile,area:a.area,city:a.city,province:a.province,areaId:a.areaId,cityId:a.cityId,provinceId:a.provinceId})}).then(()=>{z({message:"操作成功",type:"success",duration:1500,onClose:()=>{m.value=!1,U("refreshDataList",L)}})})})});return(n,e)=>{const v=W,k=Y,E=G,D=H,w=J,K=Q,R=M,j=X;return u(),b(j,{modelValue:t(m),"onUpdate:modelValue":e[9]||(e[9]=r=>re(m)?m.value=r:null),title:t(a).addrId?"修改":"新增","close-on-click-modal":!1},{footer:l(()=>[le("span",de,[o(R,{onClick:e[7]||(e[7]=r=>m.value=!1)},{default:l(()=>[N("取消")]),_:1}),o(R,{type:"primary",onClick:e[8]||(e[8]=r=>t(h)())},{default:l(()=>[N("确定")]),_:1})])]),default:l(()=>[o(K,{ref_key:"dataFormRef",ref:C,model:t(a),rules:V,"label-width":"80px",onKeyup:e[6]||(e[6]=ee(r=>t(h)(),["enter"]))},{default:l(()=>[o(k,{label:"名称",prop:"addrName"},{default:l(()=>[o(v,{modelValue:t(a).addrName,"onUpdate:modelValue":e[0]||(e[0]=r=>t(a).addrName=r),placeholder:"自提点名称"},null,8,["modelValue"])]),_:1}),o(k,{label:"省份"},{default:l(()=>[o(w,{span:8},{default:l(()=>[o(k,{prop:"province"},{default:l(()=>[o(D,{modelValue:t(a).provinceId,"onUpdate:modelValue":e[1]||(e[1]=r=>t(a).provinceId=r),placeholder:"请选择",onChange:p},{default:l(()=>[(u(!0),x(O,null,F(t(I),r=>(u(),b(E,{key:r.areaId,label:r.areaName,value:r.areaId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(w,{span:8},{default:l(()=>[o(k,{prop:"city"},{default:l(()=>[o(D,{modelValue:t(a).cityId,"onUpdate:modelValue":e[2]||(e[2]=r=>t(a).cityId=r),placeholder:"请选择",onChange:_},{default:l(()=>[(u(!0),x(O,null,F(t(c),r=>(u(),b(E,{key:r.areaId,label:r.areaName,value:r.areaId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(w,{span:8},{default:l(()=>[o(k,{prop:"area"},{default:l(()=>[o(D,{modelValue:t(a).areaId,"onUpdate:modelValue":e[3]||(e[3]=r=>t(a).areaId=r),placeholder:"请选择"},{default:l(()=>[(u(!0),x(O,null,F(t(f),r=>(u(),b(E,{key:r.areaId,label:r.areaName,value:r.areaId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(k,{label:"地址",prop:"addr"},{default:l(()=>[o(v,{modelValue:t(a).addr,"onUpdate:modelValue":e[4]||(e[4]=r=>t(a).addr=r),placeholder:"地址"},null,8,["modelValue"])]),_:1}),o(k,{label:"手机号",prop:"mobile"},{default:l(()=>[o(v,{modelValue:t(a).mobile,"onUpdate:modelValue":e[5]||(e[5]=r=>t(a).mobile=r),maxlength:"11",placeholder:"手机号"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}},ie={searchMenuSpan:6,columnBtn:!1,border:!0,index:!1,selection:!0,indexLabel:"序号",stripe:!0,menuAlign:"center",menuWidth:350,align:"center",refreshBtn:!0,searchSize:"mini",addBtn:!1,editBtn:!1,viewBtn:!1,delBtn:!1,props:{label:"label",value:"value"},column:[{label:"自提点名称",prop:"addrName",search:!0},{label:"手机号",prop:"mobile"},{label:"省份",prop:"province"},{label:"城市",prop:"city"},{label:"区/县",prop:"area"},{label:"地址",prop:"addr"}]},se={class:"mod-pickAddr"},na={__name:"index",setup(T){const A={delBtn:S("prod:prod:delete")},U=g([]),m=g([]),y=P({total:0,currentPage:1,pageSize:10}),V=(i,d,p)=>{s({url:s.adornUrl("/shop/pickAddr/page"),method:"get",params:s.adornParams(Object.assign({current:i==null?y.currentPage:i.currentPage,size:i==null?y.pageSize:i.pageSize},d))}).then(({data:_})=>{U.value=_.records,y.total=_.total,p&&p()})},I=g(!1),C=g(null),c=i=>{I.value=!0,q(()=>{var d;(d=C.value)==null||d.init(i)})},f=i=>{var p;const d=i?[i]:(p=m.value)==null?void 0:p.map(_=>_.addrId);Z.confirm("确定进行删除操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{s({url:s.adornUrl("/shop/pickAddr"),method:"delete",data:s.adornData(d,!1)}).then(()=>{z({message:"操作成功",type:"success",duration:1500,onClose:()=>{V(y)}})})}).catch(()=>{})},a=(i,d)=>{V(y,i,d)},L=i=>{m.value=i};return(i,d)=>{const p=M,_=oe("avue-crud");return u(),x("div",se,[o(_,{ref:"crudRef",page:t(y),data:t(U),option:t(ie),permission:A,onSearchChange:a,onSelectionChange:L,onOnLoad:V},{"menu-left":l(()=>[t(S)("shop:pickAddr:save")?(u(),b(p,{key:0,type:"primary",icon:"el-icon-plus",onClick:d[0]||(d[0]=$(h=>c(),["stop"]))},{default:l(()=>[N(" 新增 ")]),_:1})):B("",!0),t(S)("shop:pickAddr:delete")?(u(),b(p,{key:1,type:"danger",disabled:t(m).length<=0,onClick:d[1]||(d[1]=h=>f())},{default:l(()=>[N(" 批量删除 ")]),_:1},8,["disabled"])):B("",!0)]),menu:l(h=>[t(S)("shop:pickAddr:update")?(u(),b(p,{key:0,type:"primary",icon:"el-icon-edit",onClick:$(n=>c(h.row.addrId),["stop"])},{default:l(()=>[N(" 编辑 ")]),_:2},1032,["onClick"])):B("",!0),t(S)("shop:pickAddr:delete")?(u(),b(p,{key:1,type:"danger",icon:"el-icon-delete",onClick:$(n=>f(h.row.addrId),["stop"])},{default:l(()=>[N(" 删除 ")]),_:2},1032,["onClick"])):B("",!0)]),_:1},8,["page","data","option"]),t(I)?(u(),b(ne,{key:0,ref_key:"addOrUpdateRef",ref:C,onRefreshDataList:V},null,512)):B("",!0)])}}};export{na as default};
